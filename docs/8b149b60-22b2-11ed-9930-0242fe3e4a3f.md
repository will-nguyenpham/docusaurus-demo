---
id: "8b149b60-22b2-11ed-9930-0242fe3e4a3f"
title: "Harness Integration"
slug: "execute/cicd-integrations/harness-integration"
hide_title: true
---
import useBaseUrl from '@docusaurus/useBaseUrl';


# <a id="concept-5410" class="anchor_top_offset"/><a id="ariaid-title1" class="anchor_top_offset"/>Harness Integration

<p xmlns="http://www.w3.org/1999/xhtml" className="p">Harness is a CI/CD service platform that provides a simple and secure way for engineering and DevOps teams to release applications faster, safer, and more secure. Harness automates the entire CI/CD process, which helps build, test, and deploy improved features more quickly. To learn more about key concepts of Harness, you can refer to this Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/4o7oqwih6h-harness-key-concepts" target="_blank">Harness Key Concepts</a>.</p> 
<p xmlns="http://www.w3.org/1999/xhtml" className="p">If you are an automation tester and using Harness CI, you might want to integrate Katalon Runtime Engine (KRE) and create a CI/CI pipeline to execute your tests.</p> 
<p xmlns="http://www.w3.org/1999/xhtml" className="p">This tutorial shows you how to set up a Workflow with Harness to build your Katalon tests with the Katalon Docker image, which contains KRE, and execute the tests in a Kubernetes cluster farm.</p> 
<p xmlns="http://www.w3.org/1999/xhtml" className="p">The integration in this tutorial is performed on Harness FirstGen.</p> 

## Requirements

<p xmlns="http://www.w3.org/1999/xhtml" className="p">With the proposed scenario, you need to first configure the following components to work with Harness:</p> 
<div xmlns="http://www.w3.org/1999/xhtml" className="p"><ul className="ul"><li className="li"><p className="p">An active Katalon Runtime Engine license.</p></li><li className="li"><p className="p">A Harness account.</p></li><li className="li"><p className="p">Docker is installed and running.</p></li><li className="li"><p className="p">Kubernetes is installed and running.</p></li><li className="li"><p className="p">Kubernetes manifest files to configure the build for your Katalon Docker image. You can refer to the sample manifest files in our GitHub repository: <a className="xref j-external-link" href="https://github.com/katalon-studio-samples/ci-samples/tree/master/.harness" target="_blank">Sample manifests</a>.</p></li></ul></div>

## <a id="task-433" class="anchor_top_offset"/>Set up your Harness Account

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">   <p className="p">Before creating a Workflow in Harness, you need to set up your Account.</p>   <p className="p">Follow these steps:</p> </section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">Set up a <strong className="ph b">Harness Delegate</strong>.</span><div className="itemgroup info">For detailed instructions, see Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation" target="_blank">Harness Delegate Installation</a>.</div></li><li className="li step stepexpand"><span className="ph cmd">Set up a <strong className="ph b">Cloud Provider</strong>. </span><div className="itemgroup info">For detailed instructions on adding a Kubernetes Cloud Provider, see Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/l68rujg6mp-add-kubernetes-cluster-cloud-provider" target="_blank">Add Kubernetes Cluster Cloud Provider</a>.</div><div className="itemgroup stepxmp"><img className="image" width={600} src={useBaseUrl("/8b0f1d20-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Kubernetes Cloud Provider" /></div></li><li className="li step stepexpand"><span className="ph cmd">Add an <strong className="ph b">Artifact Server</strong>. </span><div className="itemgroup info">To add a Docker Registry Artifact Server for the Katalon Docker image, see Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/tdj2ghkqb0-add-docker-registry-artifact-servers" target="_blank">Add Docker Registry Artifact Server</a>.</div><div className="itemgroup stepxmp"><img className="image" width={600} src={useBaseUrl("/8b0ab050-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Docker Registry Artifact Server" /></div></li><li className="li step stepexpand"><span className="ph cmd">Add a <strong className="ph b">Source Repo Provider</strong>. </span><div className="itemgroup info">To add a GitHub Source Repo Provider, see Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/sip9rr6ogy-add-github-repo" target="_blank">Add a GitHub Repo</a>.</div><div className="itemgroup stepxmp"><p className="p">Here we add a GitHub Source Repo Provider with the GitHub repository URL: <code className="ph codeph">https://github.com/katalon-studio-samples/ci-samples</code>. You can fork this repository and provide your own GitHub Personal Access Token when you configure the Source Repo Provider.</p><img className="image" width={600} src={useBaseUrl("/8b0e0bb0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness GitHub Source Repo Provider" /></div></li></ol> 

## <a id="concept-5738" class="anchor_top_offset"/>Set up a Harness Application

<p xmlns="http://www.w3.org/1999/xhtml" className="p">A Harness Application represents a group of microservices, their deployment pipelines, and all the building blocks for those pipelines. Harness represents your microservice using a logical group of one or more entities: Services, Environments, Workflows, Pipelines, Triggers, and Infrastructure Provisioners.</p> 
<p xmlns="http://www.w3.org/1999/xhtml" className="p">Here we set up an Application with the necessary configurations to create Workflow for our pipeline.</p> 

### <a id="a671q74rzwbdkce" class="anchor_top_offset"/>Add a Harness Application

<div xmlns="http://www.w3.org/1999/xhtml" className="li step p"><span className="ph cmd">To add a Harness Application, you can refer to this Harness document: <a className="xref j-external-link" href="https://docs.harness.io/article/bucothemly-application-configuration#step_1_set_up_the_application" target="_blank">Set up Harness Application</a>.</span></div>

### <a id="crny6uo2dd9x3uh" class="anchor_top_offset"/>Add a Service to the Application

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">   <p className="p">Services represent your microservices/apps. You define where the artifacts for those microservices come from, and the container specs, configuration variables, and files for those microservices.</p>   <p className="p">Here we add a Service and configure it with the defined Artifact Server and manifest files.</p>   <p className="p">Follow these steps:</p> </section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">In your Application, click <span className="ph uicontrol">Service</span> &gt; <span className="ph uicontrol">Add Service</span>.</span></li><li className="li step stepexpand"><span className="ph cmd">In the opened <span className="ph uicontrol">Add Service</span> dialog, specify the name and deployment type.</span><div className="itemgroup stepxmp">As we use a Kubernetes Cloud Provider, we specify the Kubernetes Deployment Type. <img className="image" width={500} src={useBaseUrl("/8b0c0fe0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Add Service dialog" /></div></li><li className="li step stepexpand"><span className="ph cmd">Click <span className="ph uicontrol">Submit</span>.</span></li><li className="li step stepexpand"><span className="ph cmd">Add an Artifact Source. In the <span className="ph uicontrol">Service Overview</span> section of the new Service, click <span className="ph uicontrol">Add Artifact Source</span> &gt; <span className="ph uicontrol">Docker Registry</span>. </span><div className="itemgroup stepxmp">       <p className="p">Here we specify the Artifact Source with our Docker Registry Artifact Server and the name of the Katalon Docker image (<code className="ph codeph">katalonstudio/katalon</code>).</p>       <p className="p"><img className="image" width={500} src={useBaseUrl("/8b116710-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Artifact Source - Docker Registry dialog" /></p>     </div></li><li className="li step stepexpand"><span className="ph cmd">Link manifest files to the Service. In the <span className="ph uicontrol">Manifests</span> section of the Service, click on the <em className="ph i">option</em> icon (top-right corner) and select <span className="ph uicontrol">Link Remote Manifests</span>.</span><div className="itemgroup stepxmp">       <p className="p">Here we specify the Source Repository with our GitHub Source Repo Provider and the branch, folder path that contains the manifest files (<code className="ph codeph">.harness</code>).</p><img className="image" width={500} src={useBaseUrl("/8b100780-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Remote Manifests dialog" />     </div></li><li className="li step stepexpand"><span className="ph cmd">Defined a variable for Katalon API Key. In the <span className="ph uicontrol">Configuration</span> / <span className="ph uicontrol">Config Variables</span>, click <span className="ph uicontrol">Add Variable</span> and define a variable representing the Katalon API Key.</span><div className="itemgroup stepxmp">       <p className="p">In the sample manifest files, we create a variable named <code className="ph codeph">apiKey</code> to represent the Katalon API Key. Therefore, in the Service we need to define the variable and provide the value (our Katalon API Key).<img className="image" width={500} src={useBaseUrl("/8b10f1e0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Sample manifest files with apiKey variable" /></p>       <p className="p"><img className="image" width={500} src={useBaseUrl("/8b0f9250-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Config Variable dialog" /></p>       <p className="p">To get your Katalon API Key, see: <a className="xref" href="/docs/administer/settings/katalon-api-key-in-katalon-testops#id_1">Generate a Katalon API Key</a></p>     </div></li></ol> 
<section xmlns="http://www.w3.org/1999/xhtml" className="section result">   <p className="p">The Service is then configured with an Artifact Source, Kubernetes manifests stored in our GitHub repository, and a variable representing the Katalon API Key.</p>   <p className="p"><img className="image" width={700} src={useBaseUrl("/8b086660-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Service configured" /></p> </section> 

### <a id="dk2bxcgu652lz2e" class="anchor_top_offset"/>Add an Environment to the Application 

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">   <p className="p">You define your target deployment infrastructure using a Harness Environment. Environments represent your deployment infrastructures, such as Dev, QA, Stage, Production, etc.</p>   <p className="p">In our case, we add an Environment that uses the Kubernetes Cloud Provider.</p>   <p className="p">Follow these steps:</p> </section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">In your Application, click <span className="ph uicontrol">Environments</span> &gt; <span className="ph uicontrol">Add Environment</span> and create a new Environment.</span></li><li className="li step stepexpand"><span className="ph cmd">In the created Environment, click <span className="ph uicontrol">Add Infrastructure Definition</span> and specify the properties for your infrastructure.</span><div className="itemgroup stepxmp">       <p className="p">As we want to execute our tests in a Kubernetes cluster, which is defined in the Kubernetes Cloud Provider, we specify the Infrastructure as follows.</p>       <p className="p"><img className="image" width={600} src={useBaseUrl("/8b0d9680-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Infrastructure Definition" /></p>     </div></li><li className="li step stepexpand"><span className="ph cmd">Click <span className="ph uicontrol">Submit</span>.</span></li></ol> 

## <a id="concept-8672" class="anchor_top_offset"/>Create a Harness Workflow

<p xmlns="http://www.w3.org/1999/xhtml" className="p">Workflows define the deployment orchestration steps, including how a Service is deployed, verified, rolled back, and more. </p> 
<p xmlns="http://www.w3.org/1999/xhtml" className="p">Here we create a Workflow that includes steps to build, execute our tests, and finally clean up the deployed workload.</p> 

### <a id="dez0let9tzjwf3o" class="anchor_top_offset"/>Add a Workflow

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">To add a Workflow, follow these steps:</section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">In your Application, click <span className="ph uicontrol">Workflows</span> &gt; <span className="ph uicontrol">Add Workflow</span>.</span></li><li className="li step stepexpand"><span className="ph cmd">In the opened dialog, specify the properties for your Workflow.</span><div className="itemgroup stepxmp">       <p className="p">Here we create a Rolling Deployment with our defined Environment, Service, and Infrastructure.</p>       <p className="p"><img className="image" width={500} src={useBaseUrl("/8b107cb0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Workflow dialog" /></p>     </div></li><li className="li step stepexpand"><span className="ph cmd">Click <span className="ph uicontrol">Submit</span>.</span></li></ol> 

### <a id="task-2603" class="anchor_top_offset"/>Add a Workflow Variable

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">   <p className="p">In the sample manifest files, we create a Job named <code className="ph codeph">test</code>, so we need to add a Workflow Variable to help Harness Workflow identify the Job that needs executing.</p>   <p className="p"><img className="image" width={600} src={useBaseUrl("/8b10f1e0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness manifest file" /></p>   <p className="p">To add a Workflow Variable, follow these steps:</p> </section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">Open the created Workflow and select <span className="ph uicontrol">Workflow Variables</span>.</span></li><li className="li step stepexpand"><span className="ph cmd">In the opened dialog, define a variable with type <code className="ph codeph">text</code> and provide the default value (the Job name).</span><div className="itemgroup info">In our case, the value is <code className="ph codeph">test</code>.</div><div className="itemgroup stepxmp"><img className="image" width={600} src={useBaseUrl("/8b09c5f0-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Workflow Variables dialog" /></div></li></ol> 

### <a id="task-7472" class="anchor_top_offset"/>Configure the Workflow

<section xmlns="http://www.w3.org/1999/xhtml" className="section context">   <p className="p">After setting up the Workflow Variable, we configure the Workflow to deploy the test build with the included Kubernetes manifests.</p>   <p className="p">Follow these steps:</p> </section> 
<ol xmlns="http://www.w3.org/1999/xhtml" className="ol steps"><li className="li step stepexpand"><span className="ph cmd">In the <span className="ph uicontrol">Deploy</span> stage of the Workflow, add an Apply step.</span><div className="itemgroup info">This step applies our Kubernetes manifest file (<code className="ph codeph">test.yaml</code>) to build and execute our tests.</div><div className="itemgroup stepxmp"><img className="image" width={500} src={useBaseUrl("/8b0a3b20-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Apply step" /></div></li><li className="li step stepexpand"><span className="ph cmd">In the <span className="ph uicontrol">Wrap Up</span> stage of the Workflow, add a Delete step.</span><div className="itemgroup info">The Delete step helps clean up the workload deployed by the Deploy stage.</div><div className="itemgroup stepxmp"><img className="image" width={500} src={useBaseUrl("/8b0afe70-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Delete step" /></div></li><li className="li step stepexpand"><span className="ph cmd">Add a Rollback step. In the <span className="ph uicontrol">Rollback Steps</span> / <span className="ph uicontrol">Deploy</span> stage, add a Delete step as in <span className="ph uicontrol">Wrap Up</span> stage.</span><div className="itemgroup info">The Rollback steps initiate a rollback of your most-recent successful deployment.</div></li></ol> 
<section xmlns="http://www.w3.org/1999/xhtml" className="section result">   <p className="p">Your Workflow is now configured with an Apply step, a Delete step, and Rollback steps.</p>   <p className="p"><img className="image" width={600} src={useBaseUrl("/8b0d2150-22b2-11ed-9930-0242fe3e4a3f.png")} alt="Harness Workflow configured" /></p> </section> 
	

### <a id="task-7461" class="anchor_top_offset"/>Deploy the Workflow

		
<p xmlns="http://www.w3.org/1999/xhtml" className="shortdesc"> </p> 
		
<section xmlns="http://www.w3.org/1999/xhtml" className="section context"> </section> 
		
<div xmlns="http://www.w3.org/1999/xhtml" className="li step p">
  <span className="ph cmd"><br /><br />
  </span></div>
		
<section xmlns="http://www.w3.org/1999/xhtml" className="section result"> </section> 
	

